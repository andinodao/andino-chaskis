import Head from "next/head";

import Header from "../components/Header";
import { DataResultSocial } from "../components/DataResultSocial";

import { useState } from "react";
import { RespondeData, SocialMediaPost } from "./api/generate";

import { TextField, Toolbar, Button, Grid, Typography } from "@mui/material";

export default function Home() {
  const [isLoading, setisLoading] = useState(false);

  const [title, setTitle] = useState(
    "CryptoMonday 14: Como crear applicar web 3 en tu empresa"
  );
  const [description, setDescription] = useState(
    "En este segmento aremos entender a pymes y empresas pequenas como usar esta nueva dimension para incrementar sus ventas"
  );
  const [speaker, setSpeaker] = useState("Paul Garcia- tech lead Upstream");
  const [date, setDate] = useState("January 14 2023");
  const [link, setLink] = useState("https://andino.upstreamapp.com");

  const [result, setResult] = useState<SocialMediaPost[] | null>([]);

  async function onSubmit(event: any) {
    event.preventDefault();

    setisLoading(true);

    const response = await fetch("/api/generate", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
      },
      body: JSON.stringify({
        title,
        date,
        description,
        speaker,
        link,
      }),
    });
    const responseData: RespondeData = await response.json();

    setResult(responseData?.data);
    // setisLoading(false);
  }

  return (
    <div className='scrollbar-contentAll'>
      <Head>
        <title>Create Next App</title>
        <meta name='description' content='Generated by create next app' />
        <link rel='icon' href='/favicon.ico' />
      </Head>
      <Header />
      <Toolbar />

      <main className={""}>
        <Grid
          container
          alignItems='center'
          sx={{ minHeight: "calc(100vh - 220px)" }}
        >
          <Grid
            item
            xs={6}
            sx={{
              background:
                'url("https://images.unsplash.com/photo-1665686310429-ee43624978fa?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1470&q=80")',
              backgroundPosition: "center center",
              backgroundSize: "cover",
              minHeight: "calc(100vh - 220px)",
            }}
          ></Grid>
          <Grid item xs={6} px={15}>
            <Typography
              variant='h1'
              sx={{
                width: "70%",
                fontFamily: "TextaAltBold",
                fontSize: 45,
                margin: "0 auto",
                textAlign: "center",
              }}
            >
              Â¡Generador contenido social media!
            </Typography>
            <form onSubmit={onSubmit}>
              <Grid container spacing={2} py={4}>
                <Grid item xs={6}>
                  <TextField
                    type='text'
                    name='title'
                    placeholder='Enter titulo'
                    value={title}
                    onChange={(e) => setTitle(e.target.value)}
                    fullWidth
                  />
                </Grid>
                <Grid item xs={6}>
                  <TextField
                    type='text'
                    name='date'
                    placeholder='cuando es'
                    value={date}
                    onChange={(e) => setDate(e.target.value)}
                    fullWidth
                  />
                </Grid>
                <Grid item xs={12}>
                  <TextField
                    name='description'
                    placeholder='Enter a description'
                    value={description}
                    multiline
                    rows={8}
                    onChange={(e) => setDescription(e.target.value)}
                    fullWidth
                  />
                </Grid>
                <Grid item xs={6}>
                  <TextField
                    type='text'
                    name='speaker'
                    placeholder='Enter speaker'
                    value={speaker}
                    onChange={(e) => setSpeaker(e.target.value)}
                    fullWidth
                  />
                </Grid>
                <Grid item xs={6}>
                  <TextField
                    type='text'
                    name='link'
                    placeholder='Enter link'
                    value={link}
                    onChange={(e) => setLink(e.target.value)}
                    fullWidth
                  />
                </Grid>
              </Grid>
              <Grid container justifyContent='space-around' py={4}>
                <Button
                  variant='contained'
                  color='inherit'
                  sx={{
                    minWidth: "230px",
                    borderRadius: 5,
                    fontFamily: "TextaAltBold",
                    fontSize: 18,
                    textTransform: "none",
                  }}
                >
                  Limpiar formulario
                </Button>
                <Button
                  type='submit'
                  variant='contained'
                  sx={{
                    width: "230px",
                    borderRadius: 5,
                    fontFamily: "TextaAltBold",
                    fontSize: 18,
                    textTransform: "none",
                  }}
                >
                  Crear contenido
                </Button>
              </Grid>
            </form>
          </Grid>
        </Grid>

        <DataResultSocial result={result} isLoading={isLoading} />
      </main>

      {/*       <footer className={""}>
        <a
          href='https://vercel.com?utm_source=create-next-app&utm_medium=default-template&utm_campaign=create-next-app'
          target='_blank'
          rel='noopener noreferrer'
        >
          Powered by{" "}
          <span className={""}>
            <Image src='/vercel.svg' alt='Vercel Logo' width={72} height={16} />
          </span>
        </a>
      </footer> */}
    </div>
  );
}
