import Head from "next/head";

import Header from "../../components/Header";

import { useState } from "react";
import { RespondeData, SocialMediaPostResponse } from "../api/generate";

import { Toolbar, Grid } from "@mui/material";

import { useForm } from "../../hooks/useForm";
import { DataSocialMedia } from "../../components/DataSocialMedia";
import { FormGenerateSocialMedia } from "../../components/FormGenerateSocialMedia";
import {
  SocialMediaTypes,
  useGenerateSocialEventContentMutation,
} from "../../graphql/generated/generated";

export default function Home() {
  const [isLoading, setisLoading] = useState(false);

  const [doMutation, { loading, data: result }] =
    useGenerateSocialEventContentMutation();

  const { inputState, onChangeForm, onResetForm } = useForm({
    title: "CryptoMonday 14: Como crear aplicaciones web 3 en tu empresa",
    description:
      "En este segmento aremos entender a pymes y empresas pequeñas como usar esta nueva dimensión para incrementar sus ventas",
    speaker: "Paul Garcia- Tech Lead Upstream",
    date: "January 14, 2023",
    link: "https://andino.upstreamapp.com",
  });
  const { title, description, speaker, date, link } = inputState;

  async function onSubmit(event: any) {
    doMutation({
      variables: {
        body: {
          title,
          date,
          details: description,
          speaker,
          link,
        },
      },
    });

    event.preventDefault();
  }

  console.log(result);

  return (
    <div className="scrollbar-contentAll">
      <Head>
        <title>Andino Chaski</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <Header />
      <Toolbar />

      <main className={""}>
        <Grid
          container
          alignItems="center"
          sx={{
            minHeight: { xs: "calc(100vh + 160px)", sm: "calc(100vh - 64px)" },
          }}
          flexWrap="wrap-reverse"
        >
          <DataSocialMedia isLoading={isLoading} result={result || []} />

          <FormGenerateSocialMedia
            onSubmit={onSubmit}
            onChangeForm={onChangeForm}
            onResetForm={onResetForm}
            isLoading={isLoading}
            {...inputState}
          />
        </Grid>
      </main>
    </div>
  );
}
